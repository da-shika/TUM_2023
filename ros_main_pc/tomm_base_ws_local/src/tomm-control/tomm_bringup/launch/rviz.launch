<?xml version="1.0"?>
<launch>
  
  <!--############################ settings #################################-->
  <arg name="skin" default="true" />
  <arg name="ns" default="tomm" />
  <arg name="vis" default="true" />
  <arg name="controller" default="tomm"/>

  <!--############################ controllers ##############################-->

  <group ns="$(arg ns)">
    <!-- wbc parameters -->
    <rosparam command="load" file="$(find tomm_bringup)/configs/control_sim.yaml" subst_value="True"/> 
    <!-- task parameters --> 
    <rosparam command="load" file="$(find tomm_bringup)/configs/behaviors.yaml" subst_value="True"/> 
    <rosparam command="load" file="$(find tomm_bringup)/configs/tasks.yaml" subst_value="True"/> 
    <rosparam command="load" file="$(find tomm_bringup)/configs/skin.yaml" subst_value="True"/> 

    <!-- skin related -->
    <group if="$(arg skin)">      
      <include file="$(find skin_contact_generator)/launch/whole_body_contacts.launch"/>
      <group if="$(arg vis)">  
        <include file="$(find skin_visualizer)/launch/skin_visualizer.launch">
          <arg name="tf_prefix" type="string" default="tomm"/>
          <arg name="target_frame" type="string" default="base_link"/>
        </include>
      </group>
    </group>

  </group>

  <!--###################### visualizations #################################-->

  <!-- Visualization of real robot -->
  <group ns="$(arg ns)">
    <!-- note: this has to be in the robot workspace to work with h1! -->

    <node name="robot_state_publisher_vis" pkg="robot_state_publisher" type="robot_state_publisher">
      <param name="joint_states" value="/tomm/joint_states"/>
      <param name="tf_prefix" type="string" value="/tomm"/>
      <param name="publish_frequency" type="double" value="100.0"/>
    </node>
  </group>

  <!-- static transformation of real robot to robot model --> 
  <node pkg="tf" type="static_transform_publisher" name="tomm_odom_world_static_transform" args="0 0 0 0 0 0 world tomm/odom 10" />

  <node pkg="tf" type="static_transform_publisher" name="vive_world_static_transform" args="0.34 0.01 1.616 1.0 0 0 0 world marker 10" />

  <group if="$(arg vis)">
    <!-- Rviz Visualization -->
    <node type="rviz" 
          name="tomm_rviz" 
          pkg="rviz" 
          args="-d $(find tomm_bringup)/rviz/rviz.rviz" />
  </group>

</launch>